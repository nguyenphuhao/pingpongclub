# Tournament API Endpoints - Complete Summary

## üìö Table of Contents

1. [Bracket Endpoints](#bracket-endpoints) - Single Elimination matches
2. [Group Endpoints](#group-endpoints) - Round Robin matches
3. [Generic Matches API](#generic-matches-api) - Unified matches API for both stages
4. [Participant Endpoints](#participant-endpoints)
5. [Tournament Management](#tournament-management)

---

# üéØ Bracket Endpoints

> **For**: SINGLE_ELIMINATION tournaments v√† Final stage c·ªßa TWO_STAGES tournaments

## 1. Generate Bracket (Official)

**Endpoint**: `POST /api/admin/tournaments/:id/bracket/generate`

**Description**: T·∫°o t·∫•t c·∫£ bracket matches ch√≠nh th·ª©c (SCHEDULED) v·ªõi placeholders cho rounds sau

**Request Body**:
```json
{
  "includeThirdPlaceMatch": true,
  "isDraft": false  // Optional, default = false
}
```

**Response**:
```json
{
  "success": true,
  "data": {
    "tournamentId": "tour-123",
    "format": "SINGLE_ELIMINATION",
    "totalRounds": 3,
    "totalMatches": 7,
    "matches": [
      {
        "id": "match-1",
        "name": "QF1",
        "nextMatchId": "match-5",
        "tournamentRoundText": "Quarterfinals",
        "state": "SCHEDULED",
        "participants": [
          { "id": "part-1", "name": "Player 1" },
          { "id": "part-8", "name": "Player 8" }
        ]
      },
      {
        "id": "match-5",
        "name": "SF1",
        "nextMatchId": "match-7",
        "tournamentRoundText": "Semifinals",
        "state": "SCHEDULED",
        "participants": [
          { "id": "TBD-match-5-1", "name": "TBD" },
          { "id": "TBD-match-5-2", "name": "TBD" }
        ]
      }
    ]
  }
}
```

**Behavior**:
- ‚úÖ T·∫°o T·∫§T C·∫¢ matches cho T·∫§T C·∫¢ rounds ngay t·ª´ ƒë·∫ßu
- ‚úÖ Round 1: G√°n real participants
- ‚úÖ Round 2+: Kh√¥ng c√≥ participants (hi·ªÉn th·ªã TBD)
- ‚úÖ Match status = `SCHEDULED`
- ‚úÖ Tournament status ‚Üí `IN_PROGRESS`

**Requirements**:
- Tournament status = `PENDING`
- Participants ƒë√£ lock (`participantsLocked = true`)
- Ch∆∞a c√≥ bracket t·ªìn t·∫°i

---

## 2. Get Bracket (v·ªõi Placeholders)

**Endpoint**: `GET /api/admin/tournaments/:id/bracket`

**Description**: L·∫•y bracket structure v·ªõi placeholders (TBD) cho visualization

**Response**: Gi·ªëng nh∆∞ Generate Bracket response

**Behavior**:
- ‚úÖ Tr·∫£ v·ªÅ t·∫•t c·∫£ matches (k·ªÉ c·∫£ TBD)
- ‚úÖ M·ªói match c√≥ `nextMatchId` ƒë·ªÉ link winners
- ‚úÖ Participants kh√¥ng c√≥ ‚Üí hi·ªÉn th·ªã "TBD"
- ‚úÖ Compatible v·ªõi @g-loot/react-tournament-brackets

---

## 3. Generate Draft Bracket

**Endpoint**: `POST /api/admin/tournaments/:id/bracket/generate`

**Description**: T·∫°o bracket ·ªü ch·∫ø ƒë·ªô DRAFT ƒë·ªÉ preview/edit tr∆∞·ªõc khi publish

**Request Body**:
```json
{
  "includeThirdPlaceMatch": true,
  "isDraft": true  // ‚Üê Set true ƒë·ªÉ t·∫°o draft
}
```

**Response**: Gi·ªëng Generate Bracket nh∆∞ng match status = `DRAFT`

**Behavior**:
- ‚úÖ Match status = `DRAFT`
- ‚úÖ Tournament status KH√îNG thay ƒë·ªïi (gi·ªØ nguy√™n)
- ‚úÖ C√≥ th·ªÉ edit participants, schedule
- ‚úÖ KH√îNG y√™u c·∫ßu tournament = PENDING

---

## 4. Get Draft Bracket

**Endpoint**: `GET /api/admin/tournaments/:id/bracket/draft`

**Description**: L·∫•y draft bracket (ch·ªâ DRAFT matches)

**Response**:
```json
{
  "success": true,
  "data": {
    "tournamentId": "tour-123",
    "format": "SINGLE_ELIMINATION",
    "totalRounds": 3,
    "totalMatches": 7,
    "matches": [/* Ch·ªâ DRAFT matches */]
  }
}
```

**Behavior**:
- ‚úÖ Ch·ªâ tr·∫£ v·ªÅ matches c√≥ status = `DRAFT`
- ‚úÖ Tr·∫£ v·ªÅ null n·∫øu kh√¥ng c√≥ draft

---

## 5. Update Draft Match

**Endpoint**: `PATCH /api/admin/tournaments/:id/bracket/draft/:matchId`

**Description**: Edit m·ªôt draft match (participants, schedule, round)

**Request Body**:
```json
{
  "participants": [
    { "position": 1, "participantId": "part-123" },
    { "position": 2, "participantId": "part-456" }
  ],
  "matchDate": "2026-01-15T10:00:00Z",
  "courtNumber": "Court 1",
  "round": 2
}
```

**Response**:
```json
{
  "success": true,
  "data": {
    "id": "match-5",
    "status": "DRAFT",
    "round": 2,
    "matchDate": "2026-01-15T10:00:00Z",
    "courtNumber": "Court 1",
    "participants": [/* Updated participants */]
  }
}
```

**Behavior**:
- ‚úÖ Ch·ªâ edit ƒë∆∞·ª£c matches c√≥ status = `DRAFT`
- ‚úÖ C√≥ th·ªÉ ƒë·ªïi participants (swap matchups)
- ‚úÖ C√≥ th·ªÉ ƒë·ªïi schedule
- ‚úÖ C√≥ th·ªÉ ƒë·ªïi round number

---

## 6. Publish Draft Bracket

**Endpoint**: `POST /api/admin/tournaments/:id/bracket/draft/publish`

**Description**: Publish draft bracket ‚Üí chuy·ªÉn t·∫•t c·∫£ DRAFT matches th√†nh SCHEDULED

**Response**:
```json
{
  "success": true,
  "data": {
    "publishedMatches": 7,
    "bracket": {
      "tournamentId": "tour-123",
      "format": "SINGLE_ELIMINATION",
      "totalRounds": 3,
      "totalMatches": 7,
      "matches": [/* Matches b√¢y gi·ªù l√† SCHEDULED */]
    }
  }
}
```

**Behavior**:
- ‚úÖ Validate: T·∫•t c·∫£ matches ph·∫£i c√≥ valid participants (kh√¥ng c√≥ TBD)
- ‚úÖ DRAFT ‚Üí SCHEDULED (atomic)
- ‚úÖ Tournament status ‚Üí `IN_PROGRESS`
- ‚úÖ All or nothing transaction

---

## 7. Delete Draft Bracket

**Endpoint**: `DELETE /api/admin/tournaments/:id/bracket/draft`

**Description**: X√≥a t·∫•t c·∫£ draft matches

**Response**:
```json
{
  "success": true,
  "data": {
    "deletedMatches": 7,
    "message": "ƒê√£ x√≥a 7 tr·∫≠n ƒë·∫•u nh√°p"
  }
}
```

**Behavior**:
- ‚úÖ Ch·ªâ x√≥a DRAFT matches
- ‚úÖ Tournament status kh√¥ng thay ƒë·ªïi
- ‚úÖ C√≥ th·ªÉ regenerate sau khi x√≥a

---

# üèÜ Group Endpoints

> **For**: Round Robin matches trong group stage (TWO_STAGES tournaments)

## 1. Generate Group Matches (Official)

**Endpoint**: `POST /api/admin/tournaments/:id/groups/:gid/generate-matches`

**Description**: T·∫°o round robin matches ch√≠nh th·ª©c cho m·ªôt group

**Request Body**:
```json
{
  "matchupsPerPair": 1,  // M·ªói c·∫∑p ƒë·∫•u m·∫•y l·∫ßn
  "isDraft": false       // Optional, default = false
}
```

**Response**:
```json
{
  "success": true,
  "data": {
    "groupId": "group-123",
    "matchesGenerated": 6,
    "rounds": 3,
    "matches": [
      {
        "id": "match-1",
        "groupId": "group-123",
        "stage": "GROUP",
        "round": 1,
        "matchNumber": 1,
        "status": "SCHEDULED",
        "participants": [
          {
            "id": "mp-1",
            "participantId": "part-1",
            "position": 1,
            "participant": {
              "user": { "displayName": "Player 1" }
            }
          },
          {
            "id": "mp-2",
            "participantId": "part-2",
            "position": 2,
            "participant": {
              "user": { "displayName": "Player 2" }
            }
          }
        ]
      }
    ]
  }
}
```

**Behavior**:
- ‚úÖ T·∫°o round robin matches (m·ªçi ng∆∞·ªùi ƒë·∫•u v·ªõi m·ªçi ng∆∞·ªùi)
- ‚úÖ Match status = `SCHEDULED`
- ‚úÖ Group status ‚Üí `IN_PROGRESS`
- ‚úÖ T·∫•t c·∫£ matches c√≥ ƒë·ªß 2 participants (kh√¥ng c√≥ TBD)

**Requirements**:
- Group status = `PENDING`
- Group c√≥ √≠t nh·∫•t 2 participants
- Ch∆∞a c√≥ matches cho group

---

## 2. Get Group Details

**Endpoint**: `GET /api/admin/tournaments/:id/groups/:gid`

**Description**: L·∫•y th√¥ng tin group bao g·ªìm participants v√† matches

**Response**:
```json
{
  "success": true,
  "data": {
    "id": "group-123",
    "name": "Group A",
    "displayName": "B·∫£ng A",
    "status": "IN_PROGRESS",
    "participantCount": 4,
    "matchCount": 6,
    "participants": [/* Array of participants */],
    "matches": [/* Array of matches */]
  }
}
```

---

## 3. Generate Draft Group Matches

**Endpoint**: `POST /api/admin/tournaments/:id/groups/:gid/generate-matches`

**Description**: T·∫°o draft matches cho group ƒë·ªÉ preview/edit

**Request Body**:
```json
{
  "matchupsPerPair": 1,
  "isDraft": true  // ‚Üê Set true
}
```

**Response**: Gi·ªëng Generate nh∆∞ng match status = `DRAFT`

**Behavior**:
- ‚úÖ Match status = `DRAFT`
- ‚úÖ Group status KH√îNG thay ƒë·ªïi
- ‚úÖ C√≥ th·ªÉ edit schedule

---

## 4. Get Draft Group Matches

**Endpoint**: `GET /api/admin/tournaments/:id/groups/:gid/draft`

**Description**: L·∫•y draft matches c·ªßa m·ªôt group

**Response**:
```json
{
  "success": true,
  "data": [
    {
      "id": "match-1",
      "groupId": "group-123",
      "status": "DRAFT",
      "round": 1,
      "matchNumber": 1,
      "participants": [/* 2 participants */]
    }
  ]
}
```

---

## 5. Update Draft Group Match

**Endpoint**: `PATCH /api/admin/tournaments/:id/groups/:gid/draft/:matchId`

**Description**: Edit m·ªôt draft match trong group

**Request Body**:
```json
{
  "participants": [
    { "position": 1, "participantId": "part-123" },
    { "position": 2, "participantId": "part-456" }
  ],
  "matchDate": "2026-01-15T10:00:00Z",
  "courtNumber": "Court 2"
}
```

**Response**: Match ƒë√£ ƒë∆∞·ª£c update

**Behavior**:
- ‚úÖ Ch·ªâ edit DRAFT matches
- ‚úÖ Participants ph·∫£i thu·ªôc group n√†y
- ‚úÖ KH√îNG th·ªÉ ƒë·ªïi round (fixed trong round robin)

---

## 6. Publish Draft Group Matches

**Endpoint**: `POST /api/admin/tournaments/:id/groups/:gid/draft/publish`

**Description**: Publish draft matches ‚Üí SCHEDULED

**Response**:
```json
{
  "success": true,
  "data": {
    "publishedMatches": 6,
    "groupStatus": "IN_PROGRESS",
    "matches": [/* Now SCHEDULED */]
  }
}
```

**Behavior**:
- ‚úÖ Validate: T·∫•t c·∫£ matches c√≥ 2 participants
- ‚úÖ DRAFT ‚Üí SCHEDULED
- ‚úÖ Group status ‚Üí `IN_PROGRESS`
- ‚úÖ Atomic transaction

---

## 7. Delete Draft Group Matches

**Endpoint**: `DELETE /api/admin/tournaments/:id/groups/:gid/draft`

**Description**: X√≥a draft matches c·ªßa group

**Response**:
```json
{
  "success": true,
  "data": {
    "deletedMatches": 6,
    "message": "ƒê√£ x√≥a 6 tr·∫≠n ƒë·∫•u nh√°p cho b·∫£ng group-123"
  }
}
```

---

## 8. Get Group Standings

**Endpoint**: `GET /api/admin/tournaments/:id/groups/:gid/standings`

**Description**: L·∫•y b·∫£ng x·∫øp h·∫°ng c·ªßa group

**Response**:
```json
{
  "success": true,
  "data": {
    "groupId": "group-123",
    "groupName": "Group A",
    "tieBreakRules": ["WINS_VS_TIED", "GAME_SET_DIFFERENCE"],
    "standings": [
      {
        "rank": 1,
        "participant": {/* Participant info */},
        "matchRecord": { "wins": 3, "losses": 0 },
        "gameRecord": { "wins": 9, "losses": 2, "difference": 7 },
        "pointsRecord": { "for": 99, "against": 77, "difference": 22 },
        "isAdvancing": true
      }
    ]
  }
}
```

---

# üé≤ Generic Matches API

> **For**: Universal matches API supporting BOTH tournament types (SINGLE_STAGE and TWO_STAGES)
>
> **Why**: Provides unified interface for match operations across both FINAL stage (bracket) and GROUP stage (round robin) matches

## 1. List All Matches

**Endpoint**: `GET /api/admin/tournaments/:id/matches`

**Description**: Get all matches for a tournament with flexible filtering and pagination

**Query Parameters**:

| Parameter | Type | Values | Description |
|-----------|------|--------|-------------|
| `stage` | string | `FINAL`, `GROUP` | Filter by stage type |
| `groupId` | string | `<group-id>` | Filter by specific group (GROUP stage only) |
| `status` | string | `SCHEDULED`, `IN_PROGRESS`, `COMPLETED`, `CANCELLED` | Filter by match status |
| `round` | integer | `1`, `2`, `3`, ... | Filter by round number |
| `page` | integer | `1` (default) | Page number |
| `limit` | integer | `50` (default) | Items per page |

**Examples**:

```bash
# Get all matches
GET /api/admin/tournaments/tour-123/matches

# Get only bracket matches (FINAL stage)
GET /api/admin/tournaments/tour-123/matches?stage=FINAL

# Get only group matches
GET /api/admin/tournaments/tour-123/matches?stage=GROUP

# Get matches for specific group
GET /api/admin/tournaments/tour-123/matches?groupId=group-A

# Get only scheduled matches
GET /api/admin/tournaments/tour-123/matches?status=SCHEDULED

# Get round 1 matches only
GET /api/admin/tournaments/tour-123/matches?round=1

# Combined filters with pagination
GET /api/admin/tournaments/tour-123/matches?stage=GROUP&status=SCHEDULED&page=1&limit=20
```

**Response**:

```json
{
  "success": true,
  "data": {
    "data": [
      {
        "id": "match-1",
        "tournamentId": "tour-123",
        "groupId": null,
        "stage": "FINAL",
        "round": 1,
        "matchNumber": 1,
        "bracketPosition": null,
        "matchDate": "2026-01-15T10:00:00Z",
        "courtNumber": "Court 1",
        "status": "SCHEDULED",
        "winnerId": null,
        "finalScore": null,
        "gameScores": null,
        "isPlacementMatch": false,
        "placementRank": null,
        "createdAt": "2026-01-04T10:00:00Z",
        "updatedAt": "2026-01-04T10:00:00Z",
        "participants": [
          {
            "id": "mp-1",
            "participantId": "part-1",
            "position": 1,
            "isWinner": null,
            "score": null,
            "participant": {
              "id": "part-1",
              "tournamentId": "tour-123",
              "userId": "user-1",
              "groupId": null,
              "seed": 1,
              "status": "CHECKED_IN",
              "user": {
                "id": "user-1",
                "email": "player1@example.com",
                "phone": "+84901234567",
                "firstName": "Nguyen",
                "lastName": "Van A",
                "nickname": "Pro Player",
                "displayName": "Nguyen Van A",
                "ratingPoints": 1500
              }
            }
          },
          {
            "id": "mp-2",
            "participantId": "part-8",
            "position": 2,
            "isWinner": null,
            "score": null,
            "participant": {
              "user": {
                "displayName": "Player 8",
                "ratingPoints": 1200
              }
            }
          }
        ],
        "group": null
      },
      {
        "id": "match-5",
        "stage": "FINAL",
        "round": 2,
        "matchNumber": 1,
        "status": "SCHEDULED",
        "participants": [],
        "group": null
      }
    ],
    "meta": {
      "total": 15,
      "page": 1,
      "limit": 50,
      "totalPages": 1
    }
  }
}
```

**Key Features**:
- ‚úÖ Unified endpoint for both FINAL and GROUP stage matches
- ‚úÖ Empty `participants` array = TBD match (placeholder)
- ‚úÖ `stage: "FINAL"` = Bracket match
- ‚úÖ `stage: "GROUP"` = Group match
- ‚úÖ `groupId: null` = Bracket match
- ‚úÖ `groupId: "<id>"` = Group match
- ‚úÖ `group: {...}` = Group info (only for GROUP stage)
- ‚úÖ Flexible filtering by multiple criteria
- ‚úÖ Built-in pagination

---

## 2. Get Single Match

**Endpoint**: `GET /api/admin/tournaments/:id/matches/:matchId`

**Description**: Get detailed information for a specific match

**Example**:

```bash
GET /api/admin/tournaments/tour-123/matches/match-1
```

**Response**:

```json
{
  "success": true,
  "data": {
    "id": "match-1",
    "tournamentId": "tour-123",
    "groupId": "group-A",
    "stage": "GROUP",
    "round": 1,
    "matchNumber": 1,
    "status": "COMPLETED",
    "matchDate": "2026-01-15T10:00:00Z",
    "courtNumber": "Court 1",
    "winnerId": "part-1",
    "finalScore": "3-1",
    "gameScores": [
      {
        "game": 1,
        "player1Score": 11,
        "player2Score": 9,
        "duration": 300
      },
      {
        "game": 2,
        "player1Score": 11,
        "player2Score": 7,
        "duration": 280
      },
      {
        "game": 3,
        "player1Score": 9,
        "player2Score": 11,
        "duration": 320
      },
      {
        "game": 4,
        "player1Score": 11,
        "player2Score": 8,
        "duration": 290
      }
    ],
    "participants": [
      {
        "id": "mp-1",
        "participantId": "part-1",
        "position": 1,
        "isWinner": true,
        "score": "3",
        "participant": {
          "user": {
            "displayName": "Player 1",
            "ratingPoints": 1500
          }
        }
      },
      {
        "id": "mp-2",
        "participantId": "part-2",
        "position": 2,
        "isWinner": false,
        "score": "1",
        "participant": {
          "user": {
            "displayName": "Player 2",
            "ratingPoints": 1400
          }
        }
      }
    ],
    "group": {
      "id": "group-A",
      "name": "Group A",
      "displayName": "B·∫£ng A"
    }
  }
}
```

**Use Cases**:
- View complete match details including scores
- Display match information on detail page
- Check match status and participants

---

## 3. Create Match Manually

**Endpoint**: `POST /api/admin/tournaments/:id/matches`

**Description**: Create a single match manually. Supports creating:
- Bracket matches (FINAL stage)
- Group matches (GROUP stage)
- TBD matches (matches without participants - placeholders)
- Matches with specific participants

**Request Body**:

```json
{
  "stage": "FINAL",
  "groupId": "group-A",
  "round": 1,
  "matchNumber": 1,
  "bracketPosition": 1,
  "matchDate": "2026-01-15T10:00:00Z",
  "courtNumber": "Court 1",
  "status": "SCHEDULED",
  "isPlacementMatch": false,
  "placementRank": null,
  "participants": [
    {
      "participantId": "part-1",
      "position": 1
    },
    {
      "participantId": "part-2",
      "position": 2
    }
  ]
}
```

**Required Fields**:
- `stage`: `"FINAL"` or `"GROUP"`
- `round`: Round number (integer)
- `matchNumber`: Match number in round (integer)

**Optional Fields**:
- `groupId`: Required if `stage = "GROUP"`
- `bracketPosition`: For bracket visualization
- `matchDate`: ISO 8601 date-time string
- `courtNumber`: Court assignment
- `status`: Default = `"SCHEDULED"`
- `isPlacementMatch`: For 3rd place match (default = false)
- `placementRank`: Rank for placement matches (e.g., 3 for 3rd place)
- `participants`: **Omit this field to create TBD match**

**Response**:

```json
{
  "success": true,
  "data": {
    "id": "match-new",
    "tournamentId": "tour-123",
    "groupId": "group-A",
    "stage": "GROUP",
    "round": 1,
    "matchNumber": 5,
    "status": "SCHEDULED",
    "participants": [
      {
        "id": "mp-new-1",
        "participantId": "part-1",
        "position": 1,
        "participant": {
          "user": { "displayName": "Player 1" }
        }
      },
      {
        "id": "mp-new-2",
        "participantId": "part-2",
        "position": 2,
        "participant": {
          "user": { "displayName": "Player 2" }
        }
      }
    ]
  }
}
```

**Use Cases**:
- Create custom playoff matches
- Create exhibition matches
- Create placeholder matches for later rounds
- Manual bracket/group construction

**Examples**:

```bash
# Create bracket match with participants
POST /api/admin/tournaments/tour-123/matches
{
  "stage": "FINAL",
  "round": 1,
  "matchNumber": 1,
  "participants": [
    { "participantId": "part-1", "position": 1 },
    { "participantId": "part-2", "position": 2 }
  ]
}

# Create TBD placeholder match (no participants)
POST /api/admin/tournaments/tour-123/matches
{
  "stage": "FINAL",
  "round": 2,
  "matchNumber": 1
}

# Create group match
POST /api/admin/tournaments/tour-123/matches
{
  "stage": "GROUP",
  "groupId": "group-A",
  "round": 1,
  "matchNumber": 1,
  "matchDate": "2026-01-15T10:00:00Z",
  "courtNumber": "Court 2",
  "participants": [
    { "participantId": "part-3", "position": 1 },
    { "participantId": "part-4", "position": 2 }
  ]
}

# Create 3rd place match
POST /api/admin/tournaments/tour-123/matches
{
  "stage": "FINAL",
  "round": 3,
  "matchNumber": 1,
  "isPlacementMatch": true,
  "placementRank": 3
}
```

**Validation Rules**:
- ‚úÖ ADMIN role required
- ‚úÖ Tournament must exist
- ‚úÖ If `stage = "GROUP"`: `groupId` is required
- ‚úÖ If `stage = "GROUP"`: participants must belong to specified group
- ‚úÖ If participants provided: they must belong to tournament
- ‚úÖ Participant positions must be unique (1 and 2)

---

## 4. Get Match Statistics

**Endpoint**: `GET /api/admin/tournaments/:id/matches/stats`

**Description**: Get statistical overview of matches in a tournament

**Example**:

```bash
GET /api/admin/tournaments/tour-123/matches/stats
```

**Response**:

```json
{
  "success": true,
  "data": {
    "total": 22,
    "byStage": [
      {
        "stage": "GROUP",
        "count": 12
      },
      {
        "stage": "FINAL",
        "count": 10
      }
    ],
    "byStatus": [
      {
        "status": "SCHEDULED",
        "count": 15
      },
      {
        "status": "COMPLETED",
        "count": 5
      },
      {
        "status": "IN_PROGRESS",
        "count": 2
      }
    ]
  }
}
```

**Use Cases**:
- Dashboard overview
- Tournament progress tracking
- Status monitoring

---

## Generic Matches API Summary

| Method | Endpoint | Description | Admin Only |
|--------|----------|-------------|------------|
| GET | `/tournaments/:id/matches` | List all matches with filtering | ‚úÖ |
| GET | `/tournaments/:id/matches/:matchId` | Get single match detail | ‚úÖ |
| POST | `/tournaments/:id/matches` | Create match manually | ‚úÖ |
| GET | `/tournaments/:id/matches/stats` | Get match statistics | ‚úÖ |

**Key Benefits**:
- ‚úÖ Unified API for both FINAL and GROUP stage matches
- ‚úÖ Flexible filtering (stage, group, status, round)
- ‚úÖ Pagination support
- ‚úÖ TBD placeholder support
- ‚úÖ Manual match creation
- ‚úÖ Statistics overview
- ‚úÖ Consistent data format

**Related Documentation**:
- [MATCHES_API_GUIDE.md](./MATCHES_API_GUIDE.md) - Complete guide with examples
- [MATCH_FORMAT_GUIDE.md](./MATCH_FORMAT_GUIDE.md) - Match format configuration
- [TOURNAMENT_ARCHITECTURE.md](./TOURNAMENT_ARCHITECTURE.md) - System architecture

---

# üë• Participant Endpoints

## 1. Get All Participants

**Endpoint**: `GET /api/admin/tournaments/:id/participants`

**Query Params**: `?page=1&limit=20`

---

## 2. Add Single Participant

**Endpoint**: `POST /api/admin/tournaments/:id/participants`

**Request Body**:
```json
{
  "userId": "user-123",
  "groupId": "group-A",  // Optional, for TWO_STAGES
  "seed": 1              // Optional
}
```

---

## 3. Bulk Import Participants

**Endpoint**: `POST /api/admin/tournaments/:id/participants/bulk`

**Request Body**:
```json
{
  "participants": [
    { "userId": "user-1", "seed": 1 },
    { "userId": "user-2", "seed": 2 }
  ]
}
```

---

## 4. Update Participant

**Endpoint**: `PATCH /api/admin/tournaments/:id/participants/:pid`

**Request Body**:
```json
{
  "groupId": "group-B",
  "seed": 5,
  "status": "CHECKED_IN"
}
```

---

## 5. Delete Participant

**Endpoint**: `DELETE /api/admin/tournaments/:id/participants/:pid`

---

## 6. Lock Participants

**Endpoint**: `POST /api/admin/tournaments/:id/participants/lock`

**Description**: Lock participants list (required before generating matches)

**Response**:
```json
{
  "success": true,
  "data": {
    "participantsLocked": true,
    "participantCount": 16
  }
}
```

---

## 7. Unlock Participants

**Endpoint**: `POST /api/admin/tournaments/:id/participants/unlock`

**Description**: Unlock ƒë·ªÉ c√≥ th·ªÉ th√™m/x√≥a participants

---

# üéÆ Tournament Management

## 1. Get All Tournaments

**Endpoint**: `GET /api/admin/tournaments`

**Query Params**: `?status=PENDING&gameType=SINGLE_STAGE&page=1&limit=20`

---

## 2. Create Tournament

**Endpoint**: `POST /api/admin/tournaments`

**Request Body** (Single Stage):
```json
{
  "name": "Championship 2026",
  "description": "Annual championship",
  "gameType": "SINGLE_STAGE",
  "singleStageConfig": {
    "format": "SINGLE_ELIMINATION",
    "matchFormat": {
      "bestOf": 5,
      "pointsToWin": 11,
      "deuceRule": true,
      "minLeadToWin": 2
    },
    "singleEliminationConfig": {
      "hasPlacementMatches": true
    }
  }
}
```

**Request Body** (Two Stages):
```json
{
  "name": "World Cup 2026",
  "gameType": "TWO_STAGES",
  "twoStagesConfig": {
    "groupStage": {
      "format": "ROUND_ROBIN",
      "matchFormat": {
        "bestOf": 3,
        "pointsToWin": 11,
        "deuceRule": true,
        "minLeadToWin": 2
      },
      "participantsPerGroup": 4,
      "participantsAdvancing": 2,
      "matchupsPerPair": 1,
      "rankBy": "MATCH_WINS",
      "placementMethod": "SEEDED",
      "tieBreaks": ["WINS_VS_TIED", "GAME_SET_DIFFERENCE"]
    },
    "finalStage": {
      "format": "SINGLE_ELIMINATION",
      "matchFormat": {
        "bestOf": 5,
        "pointsToWin": 11,
        "deuceRule": true,
        "minLeadToWin": 2
      },
      "hasPlacementMatches": true
    }
  }
}
```

---

## 3. Get Tournament Detail

**Endpoint**: `GET /api/admin/tournaments/:id`

---

## 4. Update Tournament

**Endpoint**: `PATCH /api/admin/tournaments/:id`

**Request Body**: Gi·ªëng Create nh∆∞ng t·∫•t c·∫£ fields optional

---

## 5. Delete Tournament

**Endpoint**: `DELETE /api/admin/tournaments/:id`

**Description**: Soft delete tournament

---

# üìä Summary Tables

## Generic Matches API (4 endpoints)

| Method | Endpoint | Description | Status Support |
|--------|----------|-------------|----------------|
| GET | `/tournaments/:id/matches` | List all matches with filtering | All statuses |
| GET | `/tournaments/:id/matches/:matchId` | Get single match detail | All statuses |
| POST | `/tournaments/:id/matches` | Create match manually (supports TBD) | SCHEDULED (default) |
| GET | `/tournaments/:id/matches/stats` | Get match statistics | All statuses |

**Key Features**:
- Works for both FINAL (bracket) and GROUP (round robin) stages
- Flexible filtering by stage, groupId, status, round
- Built-in pagination support
- TBD placeholder support (omit participants field)
- Manual match creation for custom tournaments

---

## Bracket Endpoints (7 endpoints)

| Method | Endpoint | Description | Match Status | Tournament Status Change |
|--------|----------|-------------|--------------|-------------------------|
| POST | `/tournaments/:id/bracket/generate` | Generate official bracket | SCHEDULED | ‚Üí IN_PROGRESS |
| GET | `/tournaments/:id/bracket` | Get bracket with TBD | Any | No change |
| POST | `/tournaments/:id/bracket/generate` (isDraft: true) | Generate draft | DRAFT | No change |
| GET | `/tournaments/:id/bracket/draft` | Get draft bracket | DRAFT | No change |
| PATCH | `/tournaments/:id/bracket/draft/:matchId` | Update draft match | DRAFT | No change |
| POST | `/tournaments/:id/bracket/draft/publish` | Publish draft | DRAFT ‚Üí SCHEDULED | ‚Üí IN_PROGRESS |
| DELETE | `/tournaments/:id/bracket/draft` | Delete draft | DRAFT | No change |

---

## Group Endpoints (8 endpoints)

| Method | Endpoint | Description | Match Status | Group Status Change |
|--------|----------|-------------|--------------|---------------------|
| POST | `/tournaments/:id/groups/:gid/generate-matches` | Generate official | SCHEDULED | ‚Üí IN_PROGRESS |
| GET | `/tournaments/:id/groups/:gid` | Get group details | Any | No change |
| POST | `/tournaments/:id/groups/:gid/generate-matches` (isDraft: true) | Generate draft | DRAFT | No change |
| GET | `/tournaments/:id/groups/:gid/draft` | Get draft matches | DRAFT | No change |
| PATCH | `/tournaments/:id/groups/:gid/draft/:matchId` | Update draft match | DRAFT | No change |
| POST | `/tournaments/:id/groups/:gid/draft/publish` | Publish draft | DRAFT ‚Üí SCHEDULED | ‚Üí IN_PROGRESS |
| DELETE | `/tournaments/:id/groups/:gid/draft` | Delete draft | DRAFT | No change |
| GET | `/tournaments/:id/groups/:gid/standings` | Get standings | Any | No change |

---

## Participant Endpoints (7 endpoints)

| Method | Endpoint | Description |
|--------|----------|-------------|
| GET | `/tournaments/:id/participants` | List all participants |
| POST | `/tournaments/:id/participants` | Add single participant |
| POST | `/tournaments/:id/participants/bulk` | Bulk import |
| PATCH | `/tournaments/:id/participants/:pid` | Update participant |
| DELETE | `/tournaments/:id/participants/:pid` | Remove participant |
| POST | `/tournaments/:id/participants/lock` | Lock list |
| POST | `/tournaments/:id/participants/unlock` | Unlock list |

---

## Tournament Management (5 endpoints)

| Method | Endpoint | Description |
|--------|----------|-------------|
| GET | `/tournaments` | List all tournaments |
| POST | `/tournaments` | Create tournament |
| GET | `/tournaments/:id` | Get tournament detail |
| PATCH | `/tournaments/:id` | Update tournament |
| DELETE | `/tournaments/:id` | Delete tournament (soft) |

---

# üéØ Workflow Examples

## Workflow 1: Single Stage Tournament

```bash
# 1. Create tournament
POST /tournaments
{ "gameType": "SINGLE_STAGE", ... }

# 2. Add participants
POST /tournaments/:id/participants/bulk
{ "participants": [...] }

# 3. Lock participants
POST /tournaments/:id/participants/lock

# 4. Generate bracket (with placeholders for later rounds)
POST /tournaments/:id/bracket/generate

# 5. Get bracket (see TBD placeholders)
GET /tournaments/:id/bracket

# 6. Submit scores (not implemented yet)
# Winners automatically advance to next round
```

---

## Workflow 2: Two Stages with Draft Preview

```bash
# 1. Create tournament
POST /tournaments
{ "gameType": "TWO_STAGES", ... }

# 2. Add participants
POST /tournaments/:id/participants/bulk

# 3. Auto-generate groups
POST /tournaments/:id/groups/auto-generate

# 4. Lock participants
POST /tournaments/:id/participants/lock

# 5. Generate DRAFT group matches for review
POST /tournaments/:id/groups/group-A/generate-matches
{ "isDraft": true }

# 6. Review draft
GET /tournaments/:id/groups/group-A/draft

# 7. Edit match if needed
PATCH /tournaments/:id/groups/group-A/draft/match-1
{ "matchDate": "...", "courtNumber": "..." }

# 8. Publish when ready
POST /tournaments/:id/groups/group-A/draft/publish

# 9. Repeat for other groups...

# 10. After group stage, generate final bracket
POST /tournaments/:id/bracket/generate
```

---

# ‚ö†Ô∏è Missing Endpoints (Future Implementation)

## Score Submission
- `POST /tournaments/:id/matches/:matchId/score` - Submit match score
- `PATCH /tournaments/:id/matches/:matchId/score` - Update score
- `DELETE /tournaments/:id/matches/:matchId/score` - Reset score

## Match Management
- ‚úÖ ~~`GET /tournaments/:id/matches` - List all matches~~ **IMPLEMENTED**
- ‚úÖ ~~`GET /tournaments/:id/matches/:matchId` - Get match detail~~ **IMPLEMENTED**
- ‚úÖ ~~`POST /tournaments/:id/matches` - Create match manually~~ **IMPLEMENTED**
- ‚úÖ ~~`GET /tournaments/:id/matches/stats` - Get match statistics~~ **IMPLEMENTED**
- `POST /tournaments/:id/matches/:matchId/start` - Start match
- `POST /tournaments/:id/matches/:matchId/complete` - Complete match
- `PATCH /tournaments/:id/matches/:matchId` - Update match details
- `DELETE /tournaments/:id/matches/:matchId` - Delete match

## Auto-Advancement
- Winner auto-advance to next round after score submission
- Update bracket placeholders automatically

---

# üìö Related Documentation

- [TOURNAMENT_API.md](./TOURNAMENT_API.md) - Detailed API documentation
- [MATCHES_API_GUIDE.md](./MATCHES_API_GUIDE.md) - Generic matches API guide
- [MATCH_FORMAT_GUIDE.md](./MATCH_FORMAT_GUIDE.md) - Match format configuration
- [TOURNAMENT_ARCHITECTURE.md](./TOURNAMENT_ARCHITECTURE.md) - System architecture
